<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8">

  <title>üõ°Ô∏è SafePack - Malicious Package Checker</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>

    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f7f9fa; margin: 0; padding: 0; }

    .container { max-width: 480px; margin: 3em auto; background: #fff; border-radius: 12px; box-shadow: 0 2px 12px #0001; padding: 2em; }

    h1 { text-align: center; color: #1a237e; }

    .desc { color: #444; text-align: center; margin-bottom: 2em; }

    label { display: block; margin-top: 1.2em; font-weight: 500; }

    input, select, button { width: 100%; padding: 0.7em; margin-top: 0.4em; border-radius: 6px; border: 1px solid #ccc; font-size: 1em; }

    button { background: #1a237e; color: #fff; font-weight: bold; border: none; cursor: pointer; margin-top: 1.5em; }

    button:hover { background: #3949ab; }

    .result { margin-top: 2em; padding: 1.2em; border-radius: 8px; font-size: 1.1em; }

    .malicious { background: #ffeaea; color: #b30000; border: 1px solid #f44336; }

    .clean { background: #eaffea; color: #006600; border: 1px solid #4caf50; }

    .loading { color: #888; }

    .footer { text-align: center; margin-top: 2em; color: #888; font-size: 0.95em; }

    @media (max-width: 600px) {

      .container { margin: 1em; padding: 1em; }

    }

  </style>

</head>

<body>

  <div class="container">

    <h1>üõ°Ô∏è SafePack</h1>

    <div class="desc">

      Check if an open source package is flagged as <b>malicious</b>.<br>

      Powered by <a href="https://osv.dev/" target="_blank">OSV.dev</a>.<br>

      <small>Supports npm, PyPI, Go, Maven, crates.io, NuGet, RubyGems</small>

    </div>

    <form id="pkgForm">

      <label>

        Package Name:

        <input type="text" id="package" placeholder="e.g. requests" required>

      </label>

      <label>

        Version (optional):

        <input type="text" id="version" placeholder="e.g. 2.28.1">

      </label>

      <label>

        Ecosystem:

        <select id="ecosystem" required>

          <option value="npm">üü® npm (JavaScript)</option>

          <option value="PyPI">üêç PyPI (Python)</option>

          <option value="Go">üîµ Go</option>

          <option value="Maven">‚òï Maven (Java)</option>

          <option value="crates.io">ü¶Ä crates.io (Rust)</option>

          <option value="NuGet">üü£ NuGet (.NET)</option>

          <option value="RubyGems">üíé RubyGems (Ruby)</option>

        </select>

      </label>

      <button type="submit">Check Package</button>

    </form>

    <div id="result" class="result"></div>

    <div class="footer">

      Data from <a href="https://osv.dev/" target="_blank">OSV.dev</a> | Tool by SafePack

    </div>

  </div>

  <script>

    const form = document.getElementById('pkgForm');

    const resultDiv = document.getElementById('result');

    form.onsubmit = async (e) => {

      e.preventDefault();

      resultDiv.className = 'result loading';

      resultDiv.textContent = 'Checking package...';

      const packageName = document.getElementById('package').value.trim();

      const version = document.getElementById('version').value.trim();

      const ecosystem = document.getElementById('ecosystem').value;

      const payload = {

        package: { name: packageName, ecosystem: ecosystem }

      };

      if (version) payload.version = version;

      try {

        const resp = await fetch('https://api.osv.dev/v1/query', {

          method: 'POST',

          headers: { 'Content-Type': 'application/json' },

          body: JSON.stringify(payload)

        });

        const data = await resp.json();

        const vulns = data.vulns || [];

        const malVulns = vulns.filter(v => v.id.startsWith('MAL-'));

        if (malVulns.length > 0) {

          resultDiv.className = 'result malicious';

          resultDiv.innerHTML = `<b>‚ö†Ô∏è Malicious package detected!</b><br>

            <ul>${malVulns.map(v => `<li><b>${v.id}</b>: ${v.summary || ''}</li>`).join('')}</ul>

            <hr>

            <b>All vulnerabilities:</b>

            <ul>${vulns.map(v => `<li><b>${v.id}</b>: ${v.summary || ''}</li>`).join('')}</ul>`;

        } else if (vulns.length > 0) {

          resultDiv.className = 'result malicious';

          resultDiv.innerHTML = `<b>‚ö†Ô∏è Vulnerabilities found (not flagged as malware):</b>

            <ul>${vulns.map(v => `<li><b>${v.id}</b>: ${v.summary || ''}</li>`).join('')}</ul>`;

        } else {

          resultDiv.className = 'result clean';

          resultDiv.innerHTML = `<b>‚úÖ No known malware or vulnerabilities found for this package/version.</b>

            <br><small>(Always review code and maintainers before use.)</small>`;

        }

      } catch (err) {

        resultDiv.className = 'result malicious';

        resultDiv.textContent = 'Error: ' + err;

      }

    };

  </script>

</body>

</html>
